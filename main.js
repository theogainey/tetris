"use strict";(()=>{var m={I:{color:"#6EECEE",offsets:[[0,0],[30,0],[60,0],[90,0]],rightExtreme:120,downExtreme:30,vertices:[[0,0],[0,30],[120,30],[120,0]]},J:{color:"#0000E6",offsets:[[0,0],[0,30],[30,30],[60,30]],rightExtreme:90,downExtreme:60,vertices:[[0,0],[0,60],[90,60],[90,30],[30,30],[0,30]]},L:{color:"#E4A439",offsets:[[60,0],[0,30],[30,30],[60,30]],rightExtreme:90,downExtreme:60,vertices:[[60,0],[90,0],[90,60],[0,60],[0,30],[60,30]]},O:{color:"#E3E34B",offsets:[[0,0],[0,30],[30,0],[30,30]],rightExtreme:60,downExtreme:60,vertices:[[0,0],[0,60],[60,60],[60,0]]},S:{color:"#6EEC47",offsets:[[60,0],[30,0],[30,30],[0,30]],rightExtreme:60,downExtreme:60,vertices:[[0,30],[0,60],[60,60],[60,30],[90,30],[90,0],[30,0],[30,30]]},T:{color:"#921CE7",offsets:[[30,0],[30,30],[0,30],[60,30]],rightExtreme:90,downExtreme:60,vertices:[[30,0],[30,30],[0,30],[0,60],[90,60],[90,30],[60,30],[60,0]]},Z:{color:"#DC2F21",offsets:[[0,0],[30,0],[30,30],[60,30]],rightExtreme:90,downExtreme:60,vertices:[[0,0],[0,30],[30,30],[30,60],[90,60],[90,30],[60,30],[60,0]]}},S=document.getElementById("myCanvas"),e={xCurrent:0,yCurrent:0,typeCurrent:"Z",dy:30/48,lockedTetrominos:[],lockedCells:[],collisionPath:new Map};function g(t,i){let o=Math.min(...i);return t<o}function p(){let{offsets:t}=m[e.typeCurrent];return t.map(([o,n])=>({y:n+30+e.yCurrent,xStart:o+e.xCurrent,xEnd:o+30+e.xCurrent})).every(({xStart:o,xEnd:n,y:z})=>{var u,C;let s=(u=e.collisionPath.get(o))!=null?u:[30*20],x=(C=e.collisionPath.get(n))!=null?C:[30*20],E=s.filter(h=>x.includes(h));return g(z,E)})}function a(){if(p()){e.yCurrent=e.yCurrent+e.dy;return}m[e.typeCurrent].offsets.forEach(([t,i])=>{e.lockedCells.push({color:m[e.typeCurrent].color,xStart:e.xCurrent+t,yStart:e.yCurrent+i})}),m[e.typeCurrent].vertices.forEach(([t,i])=>{let o=e.collisionPath.get(t+e.xCurrent);o?e.collisionPath.set(t+e.xCurrent,o.concat(i+e.yCurrent)):e.collisionPath.set(t+e.xCurrent,[i+e.yCurrent])}),e.xCurrent=0,e.yCurrent=0}function f(t,i,o,n){t.beginPath(),t.rect(o,n,30,30),t.fillStyle=i,t.fill(),t.stroke(),t.closePath()}function y(t,i,o,n){i.offsets.forEach(([z,s])=>{f(t,i.color,o+z,n+s)})}function c(){let t=S.getContext("2d");t.clearRect(0,0,S.width,S.height),y(t,m[e.typeCurrent],e.xCurrent,e.yCurrent),e.lockedCells.forEach(({color:i,xStart:o,yStart:n})=>{f(t,i,o,n)})}function v(t){switch(t){case"ArrowRight":return e.xCurrent+m[e.typeCurrent].rightExtreme<30*10;case"ArrowLeft":return e.xCurrent-30>=0;default:return!1}}function w(t){switch(t){case"ArrowRight":e.xCurrent=e.xCurrent+30;break;case"ArrowLeft":e.xCurrent=e.xCurrent-30;break;default:e.xCurrent=e.xCurrent-30;break}}function l(){window.addEventListener("keydown",t=>{v(t.key)&&w(t.key)})}function d(){window.requestAnimationFrame(d),a(),c()}l();d();})();
//# sourceMappingURL=main.js.map
