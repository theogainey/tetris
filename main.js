"use strict";(()=>{function a(){let r=["I","J","L","O","S","T","Z"],o=Math.floor(Math.random()*r.length);return r[o]}var e=30,v=48,l={I:{color:"#6EECEE",offsets:[[0,0],[e,0],[e*2,0],[e*3,0]],vertices:[[0,0],[0,e],[e*4,e],[e*4,0]]},J:{color:"#0000E6",offsets:[[0,0],[0,e],[e,e],[e*2,e]],vertices:[[0,0],[0,e*2],[e*3,e*2],[e*3,e],[e,e],[0,e]]},L:{color:"#E4A439",offsets:[[e*2,0],[0,e],[e,e],[e*2,e]],vertices:[[e*2,0],[e*3,0],[e*3,e*2],[0,e*2],[0,e],[e*2,e]]},O:{color:"#E3E34B",offsets:[[0,0],[0,e],[e,0],[e,e]],vertices:[[0,0],[0,e*2],[e*2,e*2],[e*2,0]]},S:{color:"#6EEC47",offsets:[[e*2,0],[e,0],[e,e],[0,e]],vertices:[[0,e],[0,e*2],[e*2,e*2],[e*2,e],[e*3,e],[e*3,0],[e,0],[e,e]]},T:{color:"#921CE7",offsets:[[e,0],[e,e],[0,e],[e*2,e]],vertices:[[e,0],[e,e],[0,e],[0,e*2],[e*3,e*2],[e*3,e],[e*2,e],[e*2,0]]},Z:{color:"#DC2F21",offsets:[[0,0],[e,0],[e,e],[e*2,e]],vertices:[[0,0],[0,e],[e,e],[e,e*2],[e*3,e*2],[e*3,e],[e*2,e],[e*2,0]]}},u=document.getElementById("myCanvas"),t={xCurrent:0,yCurrent:0,typeCurrent:a(),dy:e/v,lockedCells:[]};function h(){let{offsets:r}=l[t.typeCurrent];if(!r.every(([n,s])=>s+t.yCurrent<=e*19))return!1;let o=r.map(([n])=>n+t.xCurrent);return t.lockedCells.filter(({xStart:n})=>o.includes(n)).every(({xStart:n,yStart:s})=>r.every(([c,f])=>!(n<c+t.xCurrent+e&&n+e>c+t.xCurrent&&s<f+t.yCurrent+t.dy+e&&e+s>f+t.yCurrent+t.dy)))}function m(){if(h()){t.yCurrent=t.yCurrent+t.dy;return}l[t.typeCurrent].offsets.forEach(([r,o])=>{t.lockedCells.push({color:l[t.typeCurrent].color,xStart:t.xCurrent+r,yStart:t.yCurrent+o})}),t.xCurrent=0,t.yCurrent=0,t.typeCurrent=a()}function y(r,o,i,n){r.beginPath(),r.rect(i,n,e,e),r.fillStyle=o,r.fill(),r.stroke(),r.closePath()}function x(r,o,i,n){o.offsets.forEach(([s,c])=>{y(r,o.color,i+s,n+c)})}function C(){let r=u.getContext("2d");r.clearRect(0,0,u.width,u.height),x(r,l[t.typeCurrent],t.xCurrent,t.yCurrent),t.lockedCells.forEach(({color:o,xStart:i,yStart:n})=>{y(r,o,i,n)})}function E(r){return T(r)&&k(r)}function k(r){if(r<0)return!1;let{offsets:o}=l[t.typeCurrent];return t.lockedCells.every(({xStart:i,yStart:n})=>o.every(([s,c])=>!(i<s+r+e&&i+e>s+r&&n<c+t.yCurrent+e&&e+n>c+t.yCurrent)))}function T(r){return r<0?!1:l[t.typeCurrent].offsets.every(([o])=>o+r+e<=e*10)}function d(){window.addEventListener("keydown",r=>{let o=0;switch(r.key){case"ArrowRight":o=t.xCurrent+e;break;case"ArrowLeft":o=t.xCurrent-e;break;default:break}E(o)&&(t.xCurrent=o)})}function p(){window.requestAnimationFrame(p),m(),C()}d();p();})();
